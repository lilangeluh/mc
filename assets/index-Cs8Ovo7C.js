import{g as be,a as Te}from"./index-BXVGENJY.js";import{d as Se,r as je}from"./index-BN_gmgB_.js";function Oe(f,T){for(var b=0;b<T.length;b++){const h=T[b];if(typeof h!="string"&&!Array.isArray(h)){for(const C in h)if(C!=="default"&&!(C in f)){const _=Object.getOwnPropertyDescriptor(h,C);_&&Object.defineProperty(f,C,_.get?_:{enumerable:!0,get:()=>h[C]})}}}return Object.freeze(Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}))}var K={},X={};const G=be(Se);var F={},te;function ye(){if(te)return F;te=1;Object.defineProperty(F,"__esModule",{value:!0}),F.cropTensor=F.capture=void 0;var f=G;function T(h,C){return f.tidy(function(){var _=f.browser.fromPixels(h),w=b(_,C),c=w.expandDims(0);return c.toFloat().div(f.scalar(127)).sub(f.scalar(1))})}F.capture=T;function b(h,C,_){var w=Math.min(h.shape[0],h.shape[1]),c=h.shape[0]/2,e=c-w/2,n=h.shape[1]/2,i=n-w/2;if(C&&!_){var t=h.slice([e,i,0],[w,w,3]);t=t.reshape([w*w,1,3]);var a=[.2989,.587,.114];return t=f.mul(t,a),t=t.reshape([w,w,3]),t=f.sum(t,-1),t=f.expandDims(t,-1),t}return h.slice([e,i,0],[w,w,3])}return F.cropTensor=b,F}var P={},re;function me(){if(re)return P;re=1;Object.defineProperty(P,"__esModule",{value:!0}),P.cropTo=P.resizeMinTo=P.resizeMaxTo=P.resize=void 0;var f=function(){return document.createElement("canvas")};function T(_,w,c){c===void 0&&(c=f()),c.width=_.width*w,c.height=_.height*w;var e=c.getContext("2d");return e.drawImage(_,0,0,c.width,c.height),c}P.resize=T;function b(_,w,c){c===void 0&&(c=f());var e=Math.max(_.width,_.height);return T(_,w/e,c)}P.resizeMaxTo=b;function h(_,w,c){c===void 0&&(c=f());var e=Math.min(_.width,_.height);return T(_,w/e,c)}P.resizeMinTo=h;function C(_,w,c,e){c===void 0&&(c=!1),e===void 0&&(e=f());var n=_.width,i=_.height;_ instanceof HTMLVideoElement&&(n=_.videoWidth,i=_.videoHeight);var t=Math.min(n,i),a=w/t,o=Math.ceil(n*a),d=Math.ceil(i*a),g=o-w,s=d-w;e.width=e.height=w;var u=e.getContext("2d");return u.drawImage(_,~~(g/2)*-1,~~(s/2)*-1,o,d),c&&(u.scale(-1,1),u.drawImage(e,w*-1,0)),e}return P.cropTo=C,P}var V={},ne;function ge(){if(ne)return V;ne=1;Object.defineProperty(V,"__esModule",{value:!0}),V.version=void 0;var f="0.8.4-alpha2";return V.version=f,V}var ie;function we(){return ie||(ie=1,(function(f){var T=X&&X.__awaiter||function(r,v,l,j){function M(p){return p instanceof l?p:new l(function(x){x(p)})}return new(l||(l=Promise))(function(p,x){function A(R){try{O(j.next(R))}catch(z){x(z)}}function N(R){try{O(j.throw(R))}catch(z){x(z)}}function O(R){R.done?p(R.value):M(R.value).then(A,N)}O((j=j.apply(r,v||[])).next())})},b=X&&X.__generator||function(r,v){var l={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},j,M,p,x;return x={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function A(O){return function(R){return N([O,R])}}function N(O){if(j)throw new TypeError("Generator is already executing.");for(;l;)try{if(j=1,M&&(p=O[0]&2?M.return:O[0]?M.throw||((p=M.return)&&p.call(M),0):M.next)&&!(p=p.call(M,O[1])).done)return p;switch(M=0,p&&(O=[O[0]&2,p.value]),O[0]){case 0:case 1:p=O;break;case 4:return l.label++,{value:O[1],done:!1};case 5:l.label++,M=O[1],O=[0];continue;case 7:O=l.ops.pop(),l.trys.pop();continue;default:if(p=l.trys,!(p=p.length>0&&p[p.length-1])&&(O[0]===6||O[0]===2)){l=0;continue}if(O[0]===3&&(!p||O[1]>p[0]&&O[1]<p[3])){l.label=O[1];break}if(O[0]===6&&l.label<p[1]){l.label=p[1],p=O;break}if(p&&l.label<p[2]){l.label=p[2],l.ops.push(O);break}p[2]&&l.ops.pop(),l.trys.pop();continue}O=v.call(r,l)}catch(R){O=[6,R],M=0}finally{j=p=0}if(O[0]&5)throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}};Object.defineProperty(f,"__esModule",{value:!0}),f.loadFromFiles=f.load=f.loadTruncatedMobileNet=f.CustomMobileNet=f.getTopKClasses=f.IMAGE_SIZE=void 0;var h=G,C=G,_=ye(),w=me(),c=ge(),e=1,n="conv_pw_13_relu",i="out_relu",t=.25,a=.35;f.IMAGE_SIZE=224;var o=function(r){return r.packageVersion=r.packageVersion||c.version,r.packageName=r.packageName||"@teachablemachine/image",r.timeStamp=r.timeStamp||new Date().toISOString(),r.userMetadata=r.userMetadata||{},r.modelName=r.modelName||"untitled",r.labels=r.labels||[],r.imageSize=r.imageSize||f.IMAGE_SIZE,r},d=function(r){return!!r&&Array.isArray(r.labels)},g=function(r,v){if(r===1){if(v!==.25&&v!==.5&&v!==.75&&v!==1)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",t.toFixed(2)),t}else if(v!==.35&&v!==.5&&v!==.75&&v!==1)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",a.toFixed(2)),a;return v},s=function(r){if(r=r||{},r.checkpointUrl&&r.trainingLayer)return(r.alpha||r.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[r.checkpointUrl,r.trainingLayer];if(r.version=r.version||e,r.version===1){r.alpha=r.alpha||t,r.alpha=g(r.version,r.alpha),console.log("Loading mobilenet "+r.version+" and alpha "+r.alpha);var v=r.alpha.toFixed(2);return v==="1.00"&&(v="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_"+v+"_"+f.IMAGE_SIZE+"/model.json",n]}else{if(r.version===2)return r.alpha=r.alpha||a,r.alpha=g(r.version,r.alpha),console.log("Loading mobilenet "+r.version+" and alpha "+r.alpha),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_"+r.alpha.toFixed(2)+"_"+f.IMAGE_SIZE+"_no_top/model.json",i];throw new Error("MobileNet V"+r.version+" doesn't exist")}},u=function(r){return T(void 0,void 0,void 0,function(){var v,l;return b(this,function(j){switch(j.label){case 0:return typeof r!="string"?[3,3]:[4,fetch(r)];case 1:return l=j.sent(),[4,l.json()];case 2:return v=j.sent(),[3,4];case 3:if(d(r))v=r;else throw new Error("Invalid Metadata provided");j.label=4;case 4:return[2,o(v)]}})})};function y(r,v,l){return l===void 0&&(l=3),T(this,void 0,void 0,function(){var j;return b(this,function(M){switch(M.label){case 0:return[4,v.data()];case 1:return j=M.sent(),[2,h.tidy(function(){l=Math.min(l,j.length);for(var p=[],x=0;x<j.length;x++)p.push({value:j[x],index:x});p.sort(function(R,z){return z.value-R.value});for(var A=new Float32Array(l),N=new Int32Array(l),x=0;x<l;x++)A[x]=p[x].value,N[x]=p[x].index;for(var O=[],x=0;x<N.length;x++)O.push({className:r[N[x]],probability:A[x]});return O})]}})})}f.getTopKClasses=y;var m=(function(){function r(v,l){this.model=v,this._metadata=o(l)}return Object.defineProperty(r,"EXPECTED_IMAGE_SIZE",{get:function(){return f.IMAGE_SIZE},enumerable:!1,configurable:!0}),r.prototype.getMetadata=function(){return this._metadata},r.prototype.getTotalClasses=function(){var v=this.model.output,l=v.shape[1];return l},r.prototype.getClassLabels=function(){return this._metadata.labels},r.prototype.predictTopK=function(v,l,j){return l===void 0&&(l=10),j===void 0&&(j=!1),T(this,void 0,void 0,function(){var M,p,x,A=this;return b(this,function(N){switch(N.label){case 0:return M=w.cropTo(v,this._metadata.imageSize,j),p=h.tidy(function(){var O=_.capture(M,A._metadata.grayscale);return A.model.predict(O)}),[4,y(this._metadata.labels,p,l)];case 1:return x=N.sent(),C.dispose(p),[2,x]}})})},r.prototype.predict=function(v,l){return l===void 0&&(l=!1),T(this,void 0,void 0,function(){var j,M,p,x,A,N=this;return b(this,function(O){switch(O.label){case 0:return j=w.cropTo(v,this._metadata.imageSize,l),M=h.tidy(function(){var R=_.capture(j,N._metadata.grayscale);return N.model.predict(R)}),[4,M.data()];case 1:for(p=O.sent(),x=[],A=0;A<p.length;A++)x.push({className:this._metadata.labels[A],probability:p[A]});return C.dispose(M),[2,x]}})})},r.prototype.dispose=function(){this.truncatedModel.dispose()},r})();f.CustomMobileNet=m;function S(r){return T(this,void 0,void 0,function(){var v,l,j,M,p,x,A,p,x,A;return b(this,function(N){switch(N.label){case 0:return v=s(r),l=v[0],j=v[1],[4,h.loadLayersModel(l)];case 1:return M=N.sent(),r&&r.version===1?(p=M.getLayer(j),x=h.model({inputs:M.inputs,outputs:p.output}),A=h.sequential(),A.add(x),A.add(h.layers.flatten()),[2,A]):(p=M.getLayer(j),x=h.model({inputs:M.inputs,outputs:p.output}),A=h.sequential(),A.add(x),A.add(h.layers.globalAveragePooling2d({})),[2,A])}})})}f.loadTruncatedMobileNet=S;function E(r,v){return T(this,void 0,void 0,function(){var l,j,M;return b(this,function(p){switch(p.label){case 0:return[4,h.loadLayersModel(r)];case 1:return l=p.sent(),v?[4,u(v)]:[3,3];case 2:return M=p.sent(),[3,4];case 3:M=null,p.label=4;case 4:return j=M,[2,new m(l,j)]}})})}f.load=E;function q(r,v,l){return T(this,void 0,void 0,function(){var j,M,p,x;return b(this,function(A){switch(A.label){case 0:return[4,h.loadLayersModel(h.io.browserFiles([r,v]))];case 1:return j=A.sent(),[4,new Response(l).json()];case 2:return M=A.sent(),l?[4,u(M)]:[3,4];case 3:return x=A.sent(),[3,5];case 4:x=null,A.label=5;case 5:return p=x,[2,new m(j,p)]}})})}f.loadFromFiles=q})(X)),X}var D={},k={exports:{}},Ce=k.exports,ae;function Ae(){return ae||(ae=1,(function(f){(function(T,b,h){function C(e){var n=this,i=c();n.next=function(){var t=2091639*n.s0+n.c*23283064365386963e-26;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=t|0)},n.c=1,n.s0=i(" "),n.s1=i(" "),n.s2=i(" "),n.s0-=i(e),n.s0<0&&(n.s0+=1),n.s1-=i(e),n.s1<0&&(n.s1+=1),n.s2-=i(e),n.s2<0&&(n.s2+=1),i=null}function _(e,n){return n.c=e.c,n.s0=e.s0,n.s1=e.s1,n.s2=e.s2,n}function w(e,n){var i=new C(e),t=n&&n.state,a=i.next;return a.int32=function(){return i.next()*4294967296|0},a.double=function(){return a()+(a()*2097152|0)*11102230246251565e-32},a.quick=a,t&&(typeof t=="object"&&_(t,i),a.state=function(){return _(i,{})}),a}function c(){var e=4022871197,n=function(i){i=i.toString();for(var t=0;t<i.length;t++){e+=i.charCodeAt(t);var a=.02519603282416938*e;e=a>>>0,a-=e,a*=e,e=a>>>0,a-=e,e+=a*4294967296}return(e>>>0)*23283064365386963e-26};return n}b&&b.exports?b.exports=w:this.alea=w})(Ce,f)})(k)),k.exports}var W={exports:{}},Ee=W.exports,oe;function qe(){return oe||(oe=1,(function(f){(function(T,b,h){function C(c){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},c===(c|0)?e.x=c:n+=c;for(var i=0;i<n.length+64;i++)e.x^=n.charCodeAt(i)|0,e.next()}function _(c,e){return e.x=c.x,e.y=c.y,e.z=c.z,e.w=c.w,e}function w(c,e){var n=new C(c),i=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var a=n.next()>>>11,o=(n.next()>>>0)/4294967296,d=(a+o)/(1<<21);while(d===0);return d},t.int32=n.next,t.quick=t,i&&(typeof i=="object"&&_(i,n),t.state=function(){return _(n,{})}),t}b&&b.exports?b.exports=w:this.xor128=w})(Ee,f)})(W)),W.exports}var U={exports:{}},Ne=U.exports,ue;function Re(){return ue||(ue=1,(function(f){(function(T,b,h){function C(c){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^(t^t<<1))|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,c===(c|0)?e.x=c:n+=c;for(var i=0;i<n.length+64;i++)e.x^=n.charCodeAt(i)|0,i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function _(c,e){return e.x=c.x,e.y=c.y,e.z=c.z,e.w=c.w,e.v=c.v,e.d=c.d,e}function w(c,e){var n=new C(c),i=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var a=n.next()>>>11,o=(n.next()>>>0)/4294967296,d=(a+o)/(1<<21);while(d===0);return d},t.int32=n.next,t.quick=t,i&&(typeof i=="object"&&_(i,n),t.state=function(){return _(n,{})}),t}b&&b.exports?b.exports=w:this.xorwow=w})(Ne,f)})(U)),U.exports}var Y={exports:{}},De=Y.exports,se;function Pe(){return se||(se=1,(function(f){(function(T,b,h){function C(c){var e=this;e.next=function(){var i=e.x,t=e.i,a,o;return a=i[t],a^=a>>>7,o=a^a<<24,a=i[t+1&7],o^=a^a>>>10,a=i[t+3&7],o^=a^a>>>3,a=i[t+4&7],o^=a^a<<7,a=i[t+7&7],a=a^a<<13,o^=a^a<<9,i[t]=o,e.i=t+1&7,o};function n(i,t){var a,o=[];if(t===(t|0))o[0]=t;else for(t=""+t,a=0;a<t.length;++a)o[a&7]=o[a&7]<<15^t.charCodeAt(a)+o[a+1&7]<<13;for(;o.length<8;)o.push(0);for(a=0;a<8&&o[a]===0;++a);for(a==8?o[7]=-1:o[a],i.x=o,i.i=0,a=256;a>0;--a)i.next()}n(e,c)}function _(c,e){return e.x=c.x.slice(),e.i=c.i,e}function w(c,e){c==null&&(c=+new Date);var n=new C(c),i=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var a=n.next()>>>11,o=(n.next()>>>0)/4294967296,d=(a+o)/(1<<21);while(d===0);return d},t.int32=n.next,t.quick=t,i&&(i.x&&_(i,n),t.state=function(){return _(n,{})}),t}b&&b.exports?b.exports=w:this.xorshift7=w})(De,f)})(Y)),Y.exports}var H={exports:{}},Ie=H.exports,ce;function ze(){return ce||(ce=1,(function(f){(function(T,b,h){function C(c){var e=this;e.next=function(){var i=e.w,t=e.X,a=e.i,o,d;return e.w=i=i+1640531527|0,d=t[a+34&127],o=t[a=a+1&127],d^=d<<13,o^=o<<17,d^=d>>>15,o^=o>>>12,d=t[a]=d^o,e.i=a,d+(i^i>>>16)|0};function n(i,t){var a,o,d,g,s,u=[],y=128;for(t===(t|0)?(o=t,t=null):(t=t+"\0",o=0,y=Math.max(y,t.length)),d=0,g=-32;g<y;++g)t&&(o^=t.charCodeAt((g+32)%t.length)),g===0&&(s=o),o^=o<<10,o^=o>>>15,o^=o<<4,o^=o>>>13,g>=0&&(s=s+1640531527|0,a=u[g&127]^=o+s,d=a==0?d+1:0);for(d>=128&&(u[(t&&t.length||0)&127]=-1),d=127,g=512;g>0;--g)o=u[d+34&127],a=u[d=d+1&127],o^=o<<13,a^=a<<17,o^=o>>>15,a^=a>>>12,u[d]=o^a;i.w=s,i.X=u,i.i=d}n(e,c)}function _(c,e){return e.i=c.i,e.w=c.w,e.X=c.X.slice(),e}function w(c,e){c==null&&(c=+new Date);var n=new C(c),i=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var a=n.next()>>>11,o=(n.next()>>>0)/4294967296,d=(a+o)/(1<<21);while(d===0);return d},t.int32=n.next,t.quick=t,i&&(i.X&&_(i,n),t.state=function(){return _(n,{})}),t}b&&b.exports?b.exports=w:this.xor4096=w})(Ie,f)})(H)),H.exports}var Z={exports:{}},Le=Z.exports,le;function Xe(){return le||(le=1,(function(f){(function(T,b,h){function C(c){var e=this,n="";e.next=function(){var t=e.b,a=e.c,o=e.d,d=e.a;return t=t<<25^t>>>7^a,a=a-o|0,o=o<<24^o>>>8^d,d=d-t|0,e.b=t=t<<20^t>>>12^a,e.c=a=a-o|0,e.d=o<<16^a>>>16^d,e.a=d-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,c===Math.floor(c)?(e.a=c/4294967296|0,e.b=c|0):n+=c;for(var i=0;i<n.length+20;i++)e.b^=n.charCodeAt(i)|0,e.next()}function _(c,e){return e.a=c.a,e.b=c.b,e.c=c.c,e.d=c.d,e}function w(c,e){var n=new C(c),i=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var a=n.next()>>>11,o=(n.next()>>>0)/4294967296,d=(a+o)/(1<<21);while(d===0);return d},t.int32=n.next,t.quick=t,i&&(typeof i=="object"&&_(i,n),t.state=function(){return _(n,{})}),t}b&&b.exports?b.exports=w:this.tychei=w})(Le,f)})(Z)),Z.exports}var Q={exports:{}},fe;function Fe(){return fe||(fe=1,(function(f){(function(T,b){var h=(0,eval)("this"),C=256,_=6,w=52,c="random",e=b.pow(C,_),n=b.pow(2,w),i=n*2,t=C-1,a;function o(S,E,q){var r=[];E=E==!0?{entropy:!0}:E||{};var v=u(s(E.entropy?[S,m(T)]:S??y(),3),r),l=new d(r),j=function(){for(var M=l.g(_),p=e,x=0;M<n;)M=(M+x)*C,p*=C,x=l.g(1);for(;M>=i;)M/=2,p/=2,x>>>=1;return(M+x)/p};return j.int32=function(){return l.g(4)|0},j.quick=function(){return l.g(4)/4294967296},j.double=j,u(m(l.S),T),(E.pass||q||function(M,p,x,A){return A&&(A.S&&g(A,l),M.state=function(){return g(l,{})}),x?(b[c]=M,p):M})(j,v,"global"in E?E.global:this==b,E.state)}b["seed"+c]=o;function d(S){var E,q=S.length,r=this,v=0,l=r.i=r.j=0,j=r.S=[];for(q||(S=[q++]);v<C;)j[v]=v++;for(v=0;v<C;v++)j[v]=j[l=t&l+S[v%q]+(E=j[v])],j[l]=E;(r.g=function(M){for(var p,x=0,A=r.i,N=r.j,O=r.S;M--;)p=O[A=t&A+1],x=x*C+O[t&(O[A]=O[N=t&N+p])+(O[N]=p)];return r.i=A,r.j=N,x})(C)}function g(S,E){return E.i=S.i,E.j=S.j,E.S=S.S.slice(),E}function s(S,E){var q=[],r=typeof S,v;if(E&&r=="object")for(v in S)try{q.push(s(S[v],E-1))}catch{}return q.length?q:r=="string"?S:S+"\0"}function u(S,E){for(var q=S+"",r,v=0;v<q.length;)E[t&v]=t&(r^=E[t&v]*19)+q.charCodeAt(v++);return m(E)}function y(){try{var S;return a&&(S=a.randomBytes)?S=S(C):(S=new Uint8Array(C),(h.crypto||h.msCrypto).getRandomValues(S)),m(S)}catch{var E=h.navigator,q=E&&E.plugins;return[+new Date,h,q,h.screen,m(T)]}}function m(S){return String.fromCharCode.apply(0,S)}if(u(b.random(),T),f.exports){f.exports=o;try{a=je}catch{}}})([],Math)})(Q)),Q.exports}var $,de;function Ve(){if(de)return $;de=1;var f=Ae(),T=qe(),b=Re(),h=Pe(),C=ze(),_=Xe(),w=Fe();return w.alea=f,w.xor128=T,w.xorwow=b,w.xorshift7=h,w.xor4096=C,w.tychei=_,$=w,$}var he;function Ge(){if(he)return D;he=1;var f=D&&D.__extends||(function(){var d=function(g,s){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,y){u.__proto__=y}||function(u,y){for(var m in y)y.hasOwnProperty(m)&&(u[m]=y[m])},d(g,s)};return function(g,s){d(g,s);function u(){this.constructor=g}g.prototype=s===null?Object.create(s):(u.prototype=s.prototype,new u)}})(),T=D&&D.__awaiter||function(d,g,s,u){function y(m){return m instanceof s?m:new s(function(S){S(m)})}return new(s||(s=Promise))(function(m,S){function E(v){try{r(u.next(v))}catch(l){S(l)}}function q(v){try{r(u.throw(v))}catch(l){S(l)}}function r(v){v.done?m(v.value):y(v.value).then(E,q)}r((u=u.apply(d,g||[])).next())})},b=D&&D.__generator||function(d,g){var s={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},u,y,m,S;return S={next:E(0),throw:E(1),return:E(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function E(r){return function(v){return q([r,v])}}function q(r){if(u)throw new TypeError("Generator is already executing.");for(;s;)try{if(u=1,y&&(m=r[0]&2?y.return:r[0]?y.throw||((m=y.return)&&m.call(y),0):y.next)&&!(m=m.call(y,r[1])).done)return m;switch(y=0,m&&(r=[r[0]&2,m.value]),r[0]){case 0:case 1:m=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,y=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(m=s.trys,!(m=m.length>0&&m[m.length-1])&&(r[0]===6||r[0]===2)){s=0;continue}if(r[0]===3&&(!m||r[1]>m[0]&&r[1]<m[3])){s.label=r[1];break}if(r[0]===6&&s.label<m[1]){s.label=m[1],m=r;break}if(m&&s.label<m[2]){s.label=m[2],s.ops.push(r);break}m[2]&&s.ops.pop(),s.trys.pop();continue}r=g.call(d,s)}catch(v){r=[6,v],y=0}finally{u=m=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(D,"__esModule",{value:!0}),D.createTeachable=D.TeachableMobileNet=void 0;var h=G,C=G,_=ye(),w=we(),c=Ve(),e=.15,n=function(d){return typeof d.dataId=="object"&&typeof d.shape=="object"};function i(d,g){var s=new Array(g).fill(0);return s[d]=1,s}function t(d,g){for(var s,u=d.length,y=d.slice(),m=u-1;m>0;m-=1){var S=void 0;g?S=Math.floor(g()*(m+1)):S=Math.floor(Math.random()*(m+1)),s=[y[S],y[m]],y[m]=s[0],y[S]=s[1]}return y}var a=(function(d){f(g,d);function g(s,u){var y=d.call(this,h.sequential(),u)||this;return y.totalSamples=0,y.examples=[],y.truncatedModel=s,y}return Object.defineProperty(g.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),g.prototype.addExample=function(s,u){return T(this,void 0,void 0,function(){var y,m,S;return b(this,function(E){return y=n(u)?u:_.capture(u,this._metadata.grayscale),m=this.truncatedModel.predict(y),S=m.dataSync(),y.dispose(),m.dispose(),this.examples[s].push(S),this.totalSamples++,[2]})})},g.prototype.predict=function(s,u){return u===void 0&&(u=!1),T(this,void 0,void 0,function(){return b(this,function(y){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,d.prototype.predict.call(this,s,u)]})})},g.prototype.predictTopK=function(s,u,y){return u===void 0&&(u=10),y===void 0&&(y=!1),T(this,void 0,void 0,function(){return b(this,function(m){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,d.prototype.predictTopK.call(this,s,u,y)]})})},g.prototype.prepare=function(){for(var s in this.examples)if(s.length===0)throw new Error("Add some examples before training");var u=this.convertToTfDataset();this.trainDataset=u.trainDataset,this.validationDataset=u.validationDataset},g.prototype.convertToTfDataset=function(){for(var s=0;s<this.examples.length;s++)this.examples[s]=t(this.examples[s],this.seed);for(var u=[],y=[],m=function(l){var j=i(l,S.numClasses),M=S.examples[l].length,p=Math.ceil(e*M),x=M-p,A=S.examples[l].slice(0,x).map(function(O){return{data:O,label:j}}),N=S.examples[l].slice(x).map(function(O){return{data:O,label:j}});u=u.concat(A),y=y.concat(N)},S=this,s=0;s<this.examples.length;s++)m(s);u=t(u,this.seed),y=t(y,this.seed);var E=h.data.array(u.map(function(l){return l.data})),q=h.data.array(y.map(function(l){return l.data})),r=h.data.array(u.map(function(l){return l.label})),v=h.data.array(y.map(function(l){return l.label}));return{trainDataset:h.data.zip({xs:E,ys:r}),validationDataset:h.data.zip({xs:q,ys:v})}},g.prototype.save=function(s,u){return T(this,void 0,void 0,function(){return b(this,function(y){return[2,this.model.save(s,u)]})})},g.prototype.train=function(s,u){return u===void 0&&(u={}),T(this,void 0,void 0,function(){var y,m,S,E,q,r,v,l,j,M=this;return b(this,function(p){switch(p.label){case 0:if(y=u.onTrainEnd||(function(){}),u.onTrainEnd=function(x){M.__stopTrainingResolve&&(M.__stopTrainingResolve(),M.__stopTrainingResolve=null),y(x)},this.isPrepared||this.prepare(),m=this.getLabels().length,C.util.assert(m===this.numClasses,function(){return"Can not train, has "+m+" labels and "+M.numClasses+" classes"}),S=this.truncatedModel.outputs[0].shape.slice(1),E=h.util.sizeFromShape(S),this.seed?q=h.initializers.varianceScaling({seed:3.14}):q=h.initializers.varianceScaling({}),this.trainingModel=h.sequential({layers:[h.layers.dense({inputShape:[E],units:s.denseUnits,activation:"relu",kernelInitializer:q,useBias:!0}),h.layers.dense({kernelInitializer:q,useBias:!1,activation:"softmax",units:this.numClasses})]}),r=h.train.adam(s.learningRate),this.trainingModel.compile({optimizer:r,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(s.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return v=this.trainDataset.batch(s.batchSize),l=this.validationDataset.batch(s.batchSize),[4,this.trainingModel.fitDataset(v,{epochs:s.epochs,validationData:l,callbacks:u})];case 1:return p.sent(),j=h.sequential(),j.add(this.truncatedModel),j.add(this.trainingModel),this.model=j,r.dispose(),[2,this.model]}})})},g.prototype.prepareDataset=function(){for(var s=0;s<this.numClasses;s++)this.examples[s]=[]},g.prototype.setLabel=function(s,u){this._metadata.labels[s]=u},g.prototype.setLabels=function(s){this._metadata.labels=s,this.prepareDataset()},g.prototype.getLabel=function(s){return this._metadata.labels[s]},g.prototype.getLabels=function(){return this._metadata.labels},g.prototype.setName=function(s){this._metadata.modelName=s},g.prototype.getName=function(){return this._metadata.modelName},g.prototype.stopTraining=function(){var s=this,u=new Promise(function(y,m){s.trainingModel.stopTraining=!0,s.__stopTrainingResolve=y});return u},g.prototype.dispose=function(){this.trainingModel.dispose(),d.prototype.dispose.call(this)},g.prototype.calculateAccuracyPerClass=function(){return T(this,void 0,void 0,function(){var s,u,y,m,S,E,q,r,v,l,R,j,M,p,x,A,N,O,R,z=this;return b(this,function(L){switch(L.label){case 0:return s=this.validationDataset.mapAsync(function(J){return T(z,void 0,void 0,function(){return b(this,function(Me){return[2,J.xs]})})}),u=this.validationDataset.mapAsync(function(J){return T(z,void 0,void 0,function(){return b(this,function(Me){return[2,J.ys]})})}),y=Math.min(u.size,32),m=Math.ceil(u.size/y),S=s.batch(y),E=u.batch(y),[4,S.iterator()];case 1:return q=L.sent(),[4,E.iterator()];case 2:r=L.sent(),v=[],l=[],R=0,L.label=3;case 3:return R<m?[4,q.next()]:[3,7];case 4:return j=L.sent(),M=this.trainingModel.predict(j.value),p=M.argMax(1),v.push(p),[4,r.next()];case 5:x=L.sent(),A=x.value.argMax(1),l.push(A),j.value.dispose(),M.dispose(),x.value.dispose(),L.label=6;case 6:return R++,[3,3];case 7:if(N=h.concat(l),O=h.concat(v),m!==1)for(R=0;R<v.length;R++)v[R].dispose(),l[R].dispose();return[2,{reference:N,predictions:O}]}})})},g.prototype.setSeed=function(s){this.seed=c(s)},g})(w.CustomMobileNet);D.TeachableMobileNet=a;function o(d,g){return T(this,void 0,void 0,function(){var s;return b(this,function(u){switch(u.label){case 0:return[4,w.loadTruncatedMobileNet(g)];case 1:return s=u.sent(),[2,new a(s,d)]}})})}return D.createTeachable=o,D}var I={};function B(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?B=function(b){return typeof b}:B=function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},B(f)}function ee(f,T,b){var h=b.value;if(typeof h!="function")throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(B(h)));var C=!1;return{configurable:!0,get:function(){if(C||this===f.prototype||this.hasOwnProperty(T)||typeof h!="function")return h;var w=h.bind(this);return C=!0,Object.defineProperty(this,T,{configurable:!0,get:function(){return w},set:function(e){h=e,delete this[T]}}),C=!1,w},set:function(w){h=w}}}function xe(f){var T;return typeof Reflect<"u"&&typeof Reflect.ownKeys=="function"?T=Reflect.ownKeys(f.prototype):(T=Object.getOwnPropertyNames(f.prototype),typeof Object.getOwnPropertySymbols=="function"&&(T=T.concat(Object.getOwnPropertySymbols(f.prototype)))),T.forEach(function(b){if(b!=="constructor"){var h=Object.getOwnPropertyDescriptor(f.prototype,b);typeof h.value=="function"&&Object.defineProperty(f.prototype,b,ee(f,b,h))}}),f}function ke(){return arguments.length===1?xe.apply(void 0,arguments):ee.apply(void 0,arguments)}const We=Object.freeze(Object.defineProperty({__proto__:null,boundClass:xe,boundMethod:ee,default:ke},Symbol.toStringTag,{value:"Module"})),Ue=be(We);var ve;function Ye(){if(ve)return I;ve=1;var f=I&&I.__decorate||function(e,n,i,t){var a=arguments.length,o=a<3?n:t===null?t=Object.getOwnPropertyDescriptor(n,i):t,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,i,t);else for(var g=e.length-1;g>=0;g--)(d=e[g])&&(o=(a<3?d(o):a>3?d(n,i,o):d(n,i))||o);return a>3&&o&&Object.defineProperty(n,i,o),o},T=I&&I.__awaiter||function(e,n,i,t){function a(o){return o instanceof i?o:new i(function(d){d(o)})}return new(i||(i=Promise))(function(o,d){function g(y){try{u(t.next(y))}catch(m){d(m)}}function s(y){try{u(t.throw(y))}catch(m){d(m)}}function u(y){y.done?o(y.value):a(y.value).then(g,s)}u((t=t.apply(e,n||[])).next())})},b=I&&I.__generator||function(e,n){var i={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},t,a,o,d;return d={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function g(u){return function(y){return s([u,y])}}function s(u){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,a&&(o=u[0]&2?a.return:u[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,u[1])).done)return o;switch(a=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,a=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(o=i.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){i=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(u[0]===6&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=n.call(e,i)}catch(y){u=[6,y],a=0}finally{t=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(I,"__esModule",{value:!0}),I.Webcam=void 0;var h=Ue,C=me(),_={facingMode:"user",frameRate:24},w=function(e){return e.facingMode=e.facingMode||_.facingMode,e.frameRate=e.frameRate||_.frameRate,e.aspectRatio=e.aspectRatio||_.aspectRatio,e},c=(function(){function e(n,i,t){n===void 0&&(n=400),i===void 0&&(i=400),t===void 0&&(t=!1),this.width=n,this.height=i,this.flip=t}return e.prototype.getWebcam=function(n){if(n===void 0&&(n={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");n.width=640;var i=w(n),t=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:i}).then(function(a){return t.srcObject=a,t.addEventListener("loadedmetadata",function(o){var d=t.videoWidth,g=t.videoHeight;t.width=d,t.height=g}),t},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},e.prototype.setup=function(n){return n===void 0&&(n={}),T(this,void 0,void 0,function(){var i;return b(this,function(t){switch(t.label){case 0:return this.webcam?[3,2]:(i=this,[4,this.getWebcam(n)]);case 1:i.webcam=t.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),t.label=2;case 2:return[2]}})})},e.prototype.play=function(){var n=this.webcam.play();return n},e.prototype.pause=function(){this.webcam.pause()},e.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},e.prototype.update=function(){this.renderCameraToCanvas()},e.prototype.stopStreamedVideo=function(n){var i=n.srcObject,t=i.getTracks();t.forEach(function(a){a.stop()}),n.srcObject=null},e.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var n=this.canvas.getContext("2d");if(this.webcam.videoWidth!==0){var i=C.cropTo(this.webcam,this.width,this.flip);n.drawImage(i,0,0)}}},f([h.default],e.prototype,"getWebcam",null),f([h.default],e.prototype,"setup",null),f([h.default],e.prototype,"play",null),f([h.default],e.prototype,"pause",null),f([h.default],e.prototype,"stop",null),f([h.default],e.prototype,"update",null),f([h.default],e.prototype,"stopStreamedVideo",null),f([h.default],e.prototype,"renderCameraToCanvas",null),e})();return I.Webcam=c,I}var pe;function He(){return pe||(pe=1,(function(f){Object.defineProperty(f,"__esModule",{value:!0});var T=we();Object.defineProperty(f,"IMAGE_SIZE",{enumerable:!0,get:function(){return T.IMAGE_SIZE}}),Object.defineProperty(f,"CustomMobileNet",{enumerable:!0,get:function(){return T.CustomMobileNet}}),Object.defineProperty(f,"load",{enumerable:!0,get:function(){return T.load}}),Object.defineProperty(f,"loadFromFiles",{enumerable:!0,get:function(){return T.loadFromFiles}}),Object.defineProperty(f,"loadTruncatedMobileNet",{enumerable:!0,get:function(){return T.loadTruncatedMobileNet}});var b=Ge();Object.defineProperty(f,"TeachableMobileNet",{enumerable:!0,get:function(){return b.TeachableMobileNet}}),Object.defineProperty(f,"createTeachable",{enumerable:!0,get:function(){return b.createTeachable}});var h=Ye();Object.defineProperty(f,"Webcam",{enumerable:!0,get:function(){return h.Webcam}});var C=ge();Object.defineProperty(f,"version",{enumerable:!0,get:function(){return C.version}})})(K)),K}var _e=He();const Ze=Te(_e),Ke=Oe({__proto__:null,default:Ze},[_e]);export{Ke as i};
